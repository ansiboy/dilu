/*!
 * 
 *  maishu-dilu v1.4.0
 *  https://github.com/ansiboy/dilu
 *  
 *  Copyright (c) 2016-2018, shu mai <ansiboy@163.com>
 *  Licensed under the MIT License.
 * 
 */!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function l(e){try{a(r.next(e))}catch(e){o(e)}}function u(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(l,u)}a((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});var l=n(2),u=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.validateOnChanged=!0,!t)throw l.errors.argumentNull("form");for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.fields=r||[],this.form=t,this.elementEvents={}}var t,n,u;return t=e,u=[{key:"elementValue",value:function(e){return e.tagName,e.value}}],(n=[{key:"appendField",value:function(e){this.fields.push(e)}},{key:"clearErrors",value:function(){this.fields.map(function(e){return e.errorElement}).filter(function(e){return null!=e}).forEach(function(e){return e.style.display="none"})}},{key:"clearElementError",value:function(e){if(!e)throw l.errors.argumentNull("name");var t=this.fields.filter(function(t){return t.name==e}),n=!0,r=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var a=o.value;this.fieldErrorElement(a).style.display="none"}}catch(e){r=!0,i=e}finally{try{n||null==u.return||u.return()}finally{if(r)throw i}}}},{key:"setElementError",value:function(e,t){if(!e)throw l.errors.argumentNull("name");if(!t)throw l.errors.argumentNull("error");var n=this.fields.filter(function(t){return t.name==e}),r=!0,i=!1,o=void 0;try{for(var u,a=n[Symbol.iterator]();!(r=(u=a.next()).done);r=!0){var s=u.value,c=this.fieldErrorElement(s);c.style.removeProperty("display"),c.innerHTML=t}}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}}},{key:"fieldElement",value:function(e){var t=e.name,n=this.form.querySelectorAll("[name='".concat(t,"']"))[0];if(null==n)throw l.errors.elementNotExists(t);return n}},{key:"fieldErrorElement",value:function(t){if(!t.errorElement){var n=this.form.getElementsByClassName("".concat(e.errorClassName," ").concat(t.name))[0];if(!n){var r=this.fieldElement(t);(n=document.createElement("span")).className=e.errorClassName,n.style.display="none",r.nextSibling?r.parentElement.insertBefore(n,r.nextSibling):r.parentElement.appendChild(n)}t.errorElement=n}return t.errorElement}},{key:"check",value:function(){for(var e=new Array,t=0;t<this.fields.length;t++){var n=this.fields[t],r=this.fieldElement(n);if(!n.condition||0!=n.condition(r)){var i=this.checkField(n);e.push(i)}}return 0==e.filter(function(e){return 0==e}).length}},{key:"checkAsync",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,i,o,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=new Array,n=0;case 2:if(!(n<this.fields.length)){e.next=12;break}if(r=this.fields[n],i=this.fieldElement(r),!r.condition||0!=r.condition(i)){e.next=7;break}return e.abrupt("continue",9);case 7:o=this.checkFieldAsync(r),t.push(o);case 9:n++,e.next=2;break;case 12:return e.next=14,Promise.all(t);case 14:return l=e.sent,u=0==l.filter(function(e){return 0==e}).length,e.abrupt("return",u);case 17:case"end":return e.stop()}},e,this)}))}},{key:"bindElementEvent",value:function(e,t){var n=this;if(!this.elementEvents[e.name]){var r,i=this.fieldElement(e),o=(r=!1,function(){r||(r=!0,t?n.checkFieldAsync(e).then(function(){return r=!1}).catch(function(){return r=!1}):(n.checkField(e),r=!1))});this.validateOnChanged&&(i.addEventListener("change",o),"select"!=i.tagName&&i.addEventListener("keyup",o)),this.elementEvents[e.name]=!0}}},{key:"checkField",value:function(t){this.bindElementEvent(t,!1);for(var n=this.fieldElement(t),i=t.depends||[],o=0;o<i.length;o++){var u=i[o](n);if("object"==r(u))throw new Error("Please use checkAsync method.");if(!u)return!1}for(var a=0;a<t.rules.length;a++){var s=t.rules[a],c=this.fieldElement(t);if(null==c)throw l.errors.fieldElementCanntNull();var f=e.elementValue(c),m=s.validate(f);if("object"==r(m))throw new Error("Please use checkAsync method.");if(this.showElement(!m,t,s,c),!m)return!1}return!0}},{key:"checkFieldAsync",value:function(t){return o(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i,o,u,a,s,c,f,m,h;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:this.bindElementEvent(t,!0),r=this.fieldElement(t),i=t.depends||[],o=0;case 4:if(!(o<i.length)){n.next=15;break}return"boolean"==typeof(u=i[o](r))&&(u=Promise.resolve(u)),n.next=9,u;case 9:if(n.sent){n.next=12;break}return n.abrupt("return",!1);case 12:o++,n.next=4;break;case 15:a=0;case 16:if(!(a<t.rules.length)){n.next=33;break}if(s=t.rules[a],null!=(c=this.fieldElement(t))){n.next=21;break}throw l.errors.fieldElementCanntNull();case 21:return f=e.elementValue(c),"boolean"==typeof(m=s.validate(f))&&(m=Promise.resolve(m)),n.next=26,m;case 26:if(h=n.sent,this.showElement(!h,t,s,c),h){n.next=30;break}return n.abrupt("return",!1);case 30:a++,n.next=16;break;case 33:return n.abrupt("return",!0);case 34:case"end":return n.stop()}},n,this)}))}},{key:"showElement",value:function(e,t,n,r){var i=this.fieldErrorElement(t);if(console.assert(null!=i,"errorElement cannt be null."),null!=n.error){i=t.errorElement;var o=this.elementName(r),l="string"==typeof n.error?n.error:n.error()||"";i.innerHTML=l.replace("%s",o)}e?i.style.removeProperty("display"):i.style.display="none"}},{key:"checkElementAsync",value:function(e){var t=this.fields.filter(function(t){return t.name==e})[0];if(!t)throw l.errors.elementNotExists(e);return this.checkFieldAsync(t)}},{key:"checkElement",value:function(e){var t=this.fields.filter(function(t){return t.name==e})[0];if(!t)throw l.errors.elementNotExists(e);return this.checkField(t)}},{key:"elementName",value:function(e){return e.tagName,e.name}}])&&i(t.prototype,n),u&&i(t,u),e}();t.FormValidator=u,u.errorClassName="validationMessage"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.FormValidator=r.FormValidator;var i=n(3);t.rules=i.rules},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errors={argumentNull:function(e){var t="Parameter ".concat(e," can not be null or empty.");return new Error(t)},elementValidateRuleNotSet:function(e){var t="元素'".concat(e.name,"'没有设置验证规则");return new Error(t)},fieldElementCanntNull:function(e){var t=null!=e?"The element value in the field cannt be null, field index is ".concat(e,"."):"The element in the field is null";return new Error(t)},elementNotExists:function(e){var t="Element ".concat(e," is not exits in the form.");return new Error(t)},fieldResultExpectBooleanType:function(e){var t="Result of ".concat(e," field is expected boolean.");return new Error(t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=/^[0-9]+$/,o=/^\-?[0-9]*\.?[0-9]+$/,l=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,u=/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/i,a=/^((http|https):\/\/(\w+:{0,1}\w*@)?(\S+)|)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,s=/^1[34578]\d{9}$/,c=/\d{4}-\d{1,2}-\d{1,2}/,f="%s不能为空",m="%s与%s不匹配",h="%s和%s必须相同",d="%s至少包含%s个字符",v="The %s field must contain a number greater than %s.",y="The %s field must contain a number less than %s.",p="请数入数字",E="The %s field must contain a valid IP.",b="The %s field must contain a valid URL.",g="请输入正确的手机号码",k="请输入正确制";function w(e,t){return{validate:e,error:t}}function x(e){return"function"==typeof e?e():e}function N(e,t){var n;return(n="number"==typeof t?o.test(e)?parseFloat(e):null:"string"==typeof t?e:function(e){if(!e.match("today")&&!e.match(c))return null;var t,n=new Date;e.match("today")||(t=e.split("-"),n.setFullYear(t[0]),n.setMonth(t[1]-1),n.setDate(t[2]));return n}(e))<t?"lessThan":n>t?"greaterThan":"equal"}t.rules={required:function(e){return w(function(e){return""!=e},e||f)},matches:function(e,t){return w(function(t){return t==r.FormValidator.elementValue(e)},t||f)},email:function(e){return w(function(e){return l.test(e)},e||f)},minLength:function(e,t){return w(function(t){return(t||"").length>=x(e)},t||d)},maxLength:function(e,t){return w(function(t){return(t||"").length<=x(e)},t||m)},greaterThan:function(e,t){return w(function(t){return"greaterThan"==N(t,x(e))},t||v)},lessThan:function(e,t){return w(function(t){return"lessThan"==N(t,x(e))},t||y)},equal:function(e,t){return w(function(t){return"equal"==N(t,x(e))},t||h)},ip:function(e){return w(function(e){return u.test(e)},e||E)},url:function(e){return w(function(e){return a.test(e)},e||b)},mobile:function(e){return w(function(e){return s.test(e)},e||g)},numeric:function(e){return w(function(e){return i.test(e)},e||p)},custom:function(e,t){return w(e,t||k)}}}]);
//# sourceMappingURL=index.es5.min.js.map